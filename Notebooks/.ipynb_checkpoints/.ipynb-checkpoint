{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "# SQL Alchemy\n",
    "from sqlalchemy import create_engine, inspect\n",
    "from sqlalchemy import Column, Integer, String, Float\n",
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Path to sqlite\n",
    "database_path = \"../Data/wdi_kaggle.sqlite\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Country\n",
      "CountryNotes\n",
      "Footnotes\n",
      "Indicators\n",
      "Series\n",
      "SeriesNotes\n"
     ]
    }
   ],
   "source": [
    "# Create engine\n",
    "engine = create_engine(f\"sqlite:///{database_path}\")\n",
    "for table_name in inspect(engine).get_table_names():\n",
    "   print(table_name)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Connecting to engine\n",
    "conn = engine.connect()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>CountryCode</th>\n",
       "      <th>ShortName</th>\n",
       "      <th>TableName</th>\n",
       "      <th>LongName</th>\n",
       "      <th>Alpha2Code</th>\n",
       "      <th>CurrencyUnit</th>\n",
       "      <th>SpecialNotes</th>\n",
       "      <th>Region</th>\n",
       "      <th>IncomeGroup</th>\n",
       "      <th>Wb2Code</th>\n",
       "      <th>...</th>\n",
       "      <th>GovernmentAccountingConcept</th>\n",
       "      <th>ImfDataDisseminationStandard</th>\n",
       "      <th>LatestPopulationCensus</th>\n",
       "      <th>LatestHouseholdSurvey</th>\n",
       "      <th>SourceOfMostRecentIncomeAndExpenditureData</th>\n",
       "      <th>VitalRegistrationComplete</th>\n",
       "      <th>LatestAgriculturalCensus</th>\n",
       "      <th>LatestIndustrialData</th>\n",
       "      <th>LatestTradeData</th>\n",
       "      <th>LatestWaterWithdrawalData</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AFG</td>\n",
       "      <td>Afghanistan</td>\n",
       "      <td>Afghanistan</td>\n",
       "      <td>Islamic State of Afghanistan</td>\n",
       "      <td>AF</td>\n",
       "      <td>Afghan afghani</td>\n",
       "      <td>Fiscal year end: March 20; reporting period fo...</td>\n",
       "      <td>South Asia</td>\n",
       "      <td>Low income</td>\n",
       "      <td>AF</td>\n",
       "      <td>...</td>\n",
       "      <td>Consolidated central government</td>\n",
       "      <td>General Data Dissemination System (GDDS)</td>\n",
       "      <td>1979</td>\n",
       "      <td>Multiple Indicator Cluster Survey (MICS), 2010/11</td>\n",
       "      <td>Integrated household survey (IHS), 2008</td>\n",
       "      <td></td>\n",
       "      <td>2013/14</td>\n",
       "      <td></td>\n",
       "      <td>2013</td>\n",
       "      <td>2000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>ALB</td>\n",
       "      <td>Albania</td>\n",
       "      <td>Albania</td>\n",
       "      <td>Republic of Albania</td>\n",
       "      <td>AL</td>\n",
       "      <td>Albanian lek</td>\n",
       "      <td></td>\n",
       "      <td>Europe &amp; Central Asia</td>\n",
       "      <td>Upper middle income</td>\n",
       "      <td>AL</td>\n",
       "      <td>...</td>\n",
       "      <td>Budgetary central government</td>\n",
       "      <td>General Data Dissemination System (GDDS)</td>\n",
       "      <td>2011</td>\n",
       "      <td>Demographic and Health Survey (DHS), 2008/09</td>\n",
       "      <td>Living Standards Measurement Study Survey (LSM...</td>\n",
       "      <td>Yes</td>\n",
       "      <td>2012</td>\n",
       "      <td>2011</td>\n",
       "      <td>2013</td>\n",
       "      <td>2006</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>DZA</td>\n",
       "      <td>Algeria</td>\n",
       "      <td>Algeria</td>\n",
       "      <td>People's Democratic Republic of Algeria</td>\n",
       "      <td>DZ</td>\n",
       "      <td>Algerian dinar</td>\n",
       "      <td></td>\n",
       "      <td>Middle East &amp; North Africa</td>\n",
       "      <td>Upper middle income</td>\n",
       "      <td>DZ</td>\n",
       "      <td>...</td>\n",
       "      <td>Budgetary central government</td>\n",
       "      <td>General Data Dissemination System (GDDS)</td>\n",
       "      <td>2008</td>\n",
       "      <td>Multiple Indicator Cluster Survey (MICS), 2012</td>\n",
       "      <td>Integrated household survey (IHS), 1995</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>2010</td>\n",
       "      <td>2013</td>\n",
       "      <td>2001</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>ASM</td>\n",
       "      <td>American Samoa</td>\n",
       "      <td>American Samoa</td>\n",
       "      <td>American Samoa</td>\n",
       "      <td>AS</td>\n",
       "      <td>U.S. dollar</td>\n",
       "      <td></td>\n",
       "      <td>East Asia &amp; Pacific</td>\n",
       "      <td>Upper middle income</td>\n",
       "      <td>AS</td>\n",
       "      <td>...</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>2010</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>Yes</td>\n",
       "      <td>2007</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>ADO</td>\n",
       "      <td>Andorra</td>\n",
       "      <td>Andorra</td>\n",
       "      <td>Principality of Andorra</td>\n",
       "      <td>AD</td>\n",
       "      <td>Euro</td>\n",
       "      <td></td>\n",
       "      <td>Europe &amp; Central Asia</td>\n",
       "      <td>High income: nonOECD</td>\n",
       "      <td>AD</td>\n",
       "      <td>...</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>2011. Population data compiled from administra...</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>Yes</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>2006</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows Ã— 31 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "  CountryCode       ShortName       TableName  \\\n",
       "0         AFG     Afghanistan     Afghanistan   \n",
       "1         ALB         Albania         Albania   \n",
       "2         DZA         Algeria         Algeria   \n",
       "3         ASM  American Samoa  American Samoa   \n",
       "4         ADO         Andorra         Andorra   \n",
       "\n",
       "                                  LongName Alpha2Code    CurrencyUnit  \\\n",
       "0             Islamic State of Afghanistan         AF  Afghan afghani   \n",
       "1                      Republic of Albania         AL    Albanian lek   \n",
       "2  People's Democratic Republic of Algeria         DZ  Algerian dinar   \n",
       "3                           American Samoa         AS     U.S. dollar   \n",
       "4                  Principality of Andorra         AD            Euro   \n",
       "\n",
       "                                        SpecialNotes  \\\n",
       "0  Fiscal year end: March 20; reporting period fo...   \n",
       "1                                                      \n",
       "2                                                      \n",
       "3                                                      \n",
       "4                                                      \n",
       "\n",
       "                       Region           IncomeGroup Wb2Code  \\\n",
       "0                  South Asia            Low income      AF   \n",
       "1       Europe & Central Asia   Upper middle income      AL   \n",
       "2  Middle East & North Africa   Upper middle income      DZ   \n",
       "3         East Asia & Pacific   Upper middle income      AS   \n",
       "4       Europe & Central Asia  High income: nonOECD      AD   \n",
       "\n",
       "             ...                 GovernmentAccountingConcept  \\\n",
       "0            ...             Consolidated central government   \n",
       "1            ...                Budgetary central government   \n",
       "2            ...                Budgetary central government   \n",
       "3            ...                                               \n",
       "4            ...                                               \n",
       "\n",
       "               ImfDataDisseminationStandard  \\\n",
       "0  General Data Dissemination System (GDDS)   \n",
       "1  General Data Dissemination System (GDDS)   \n",
       "2  General Data Dissemination System (GDDS)   \n",
       "3                                             \n",
       "4                                             \n",
       "\n",
       "                              LatestPopulationCensus  \\\n",
       "0                                               1979   \n",
       "1                                               2011   \n",
       "2                                               2008   \n",
       "3                                               2010   \n",
       "4  2011. Population data compiled from administra...   \n",
       "\n",
       "                               LatestHouseholdSurvey  \\\n",
       "0  Multiple Indicator Cluster Survey (MICS), 2010/11   \n",
       "1       Demographic and Health Survey (DHS), 2008/09   \n",
       "2     Multiple Indicator Cluster Survey (MICS), 2012   \n",
       "3                                                      \n",
       "4                                                      \n",
       "\n",
       "          SourceOfMostRecentIncomeAndExpenditureData  \\\n",
       "0            Integrated household survey (IHS), 2008   \n",
       "1  Living Standards Measurement Study Survey (LSM...   \n",
       "2            Integrated household survey (IHS), 1995   \n",
       "3                                                      \n",
       "4                                                      \n",
       "\n",
       "  VitalRegistrationComplete LatestAgriculturalCensus LatestIndustrialData  \\\n",
       "0                                            2013/14                        \n",
       "1                       Yes                     2012                 2011   \n",
       "2                                                                    2010   \n",
       "3                       Yes                     2007                        \n",
       "4                       Yes                                                 \n",
       "\n",
       "  LatestTradeData LatestWaterWithdrawalData  \n",
       "0            2013                      2000  \n",
       "1            2013                      2006  \n",
       "2            2013                      2001  \n",
       "3                                            \n",
       "4            2006                            \n",
       "\n",
       "[5 rows x 31 columns]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Selecting tables\n",
    "country_data = pd.read_sql(\"SELECT * FROM Country\", conn)\n",
    "country_data.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>CountryName</th>\n",
       "      <th>CountryCode</th>\n",
       "      <th>IndicatorName</th>\n",
       "      <th>IndicatorCode</th>\n",
       "      <th>Year</th>\n",
       "      <th>Value</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Arab World</td>\n",
       "      <td>ARB</td>\n",
       "      <td>Adolescent fertility rate (births per 1,000 wo...</td>\n",
       "      <td>SP.ADO.TFRT</td>\n",
       "      <td>1960</td>\n",
       "      <td>1.335609e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Arab World</td>\n",
       "      <td>ARB</td>\n",
       "      <td>Age dependency ratio (% of working-age populat...</td>\n",
       "      <td>SP.POP.DPND</td>\n",
       "      <td>1960</td>\n",
       "      <td>8.779760e+01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Arab World</td>\n",
       "      <td>ARB</td>\n",
       "      <td>Age dependency ratio, old (% of working-age po...</td>\n",
       "      <td>SP.POP.DPND.OL</td>\n",
       "      <td>1960</td>\n",
       "      <td>6.634579e+00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Arab World</td>\n",
       "      <td>ARB</td>\n",
       "      <td>Age dependency ratio, young (% of working-age ...</td>\n",
       "      <td>SP.POP.DPND.YG</td>\n",
       "      <td>1960</td>\n",
       "      <td>8.102333e+01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Arab World</td>\n",
       "      <td>ARB</td>\n",
       "      <td>Arms exports (SIPRI trend indicator values)</td>\n",
       "      <td>MS.MIL.XPRT.KD</td>\n",
       "      <td>1960</td>\n",
       "      <td>3.000000e+06</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  CountryName CountryCode                                      IndicatorName  \\\n",
       "0  Arab World         ARB  Adolescent fertility rate (births per 1,000 wo...   \n",
       "1  Arab World         ARB  Age dependency ratio (% of working-age populat...   \n",
       "2  Arab World         ARB  Age dependency ratio, old (% of working-age po...   \n",
       "3  Arab World         ARB  Age dependency ratio, young (% of working-age ...   \n",
       "4  Arab World         ARB        Arms exports (SIPRI trend indicator values)   \n",
       "\n",
       "    IndicatorCode  Year         Value  \n",
       "0     SP.ADO.TFRT  1960  1.335609e+02  \n",
       "1     SP.POP.DPND  1960  8.779760e+01  \n",
       "2  SP.POP.DPND.OL  1960  6.634579e+00  \n",
       "3  SP.POP.DPND.YG  1960  8.102333e+01  \n",
       "4  MS.MIL.XPRT.KD  1960  3.000000e+06  "
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "indicators_data = pd.read_sql(\"SELECT * FROM Indicators\", conn)\n",
    "indicators_data.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>SeriesCode</th>\n",
       "      <th>Topic</th>\n",
       "      <th>IndicatorName</th>\n",
       "      <th>ShortDefinition</th>\n",
       "      <th>LongDefinition</th>\n",
       "      <th>UnitOfMeasure</th>\n",
       "      <th>Periodicity</th>\n",
       "      <th>BasePeriod</th>\n",
       "      <th>OtherNotes</th>\n",
       "      <th>AggregationMethod</th>\n",
       "      <th>LimitationsAndExceptions</th>\n",
       "      <th>NotesFromOriginalSource</th>\n",
       "      <th>GeneralComments</th>\n",
       "      <th>Source</th>\n",
       "      <th>StatisticalConceptAndMethodology</th>\n",
       "      <th>DevelopmentRelevance</th>\n",
       "      <th>RelatedSourceLinks</th>\n",
       "      <th>OtherWebLinks</th>\n",
       "      <th>RelatedIndicators</th>\n",
       "      <th>LicenseType</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>BN.KLT.DINV.CD</td>\n",
       "      <td>Economic Policy &amp; Debt: Balance of payments: C...</td>\n",
       "      <td>Foreign direct investment, net (BoP, current US$)</td>\n",
       "      <td></td>\n",
       "      <td>Foreign direct investment are the net inflows ...</td>\n",
       "      <td></td>\n",
       "      <td>Annual</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>Note: Data are based on the sixth edition of t...</td>\n",
       "      <td>International Monetary Fund, Balance of Paymen...</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>Open</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>BX.KLT.DINV.WD.GD.ZS</td>\n",
       "      <td>Economic Policy &amp; Debt: Balance of payments: C...</td>\n",
       "      <td>Foreign direct investment, net inflows (% of GDP)</td>\n",
       "      <td></td>\n",
       "      <td>Foreign direct investment are the net inflows ...</td>\n",
       "      <td></td>\n",
       "      <td>Annual</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>Weighted average</td>\n",
       "      <td>FDI data do not give a complete picture of int...</td>\n",
       "      <td></td>\n",
       "      <td>Note: Data starting from 2005 are based on the...</td>\n",
       "      <td>International Monetary Fund, International Fin...</td>\n",
       "      <td>Data on equity flows are based on balance of p...</td>\n",
       "      <td>Private financial flows - equity and debt - ac...</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>Open</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>BX.KLT.DINV.CD.WD</td>\n",
       "      <td>Economic Policy &amp; Debt: Balance of payments: C...</td>\n",
       "      <td>Foreign direct investment, net inflows (BoP, c...</td>\n",
       "      <td></td>\n",
       "      <td>Foreign direct investment refers to direct inv...</td>\n",
       "      <td></td>\n",
       "      <td>Annual</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>Sum</td>\n",
       "      <td>FDI data do not give a complete picture of int...</td>\n",
       "      <td></td>\n",
       "      <td>Note: Data starting from 2005 are based on the...</td>\n",
       "      <td>International Monetary Fund, Balance of Paymen...</td>\n",
       "      <td>Data on equity flows are based on balance of p...</td>\n",
       "      <td>Private financial flows - equity and debt - ac...</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>Open</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>BM.KLT.DINV.GD.ZS</td>\n",
       "      <td>Economic Policy &amp; Debt: Balance of payments: C...</td>\n",
       "      <td>Foreign direct investment, net outflows (% of ...</td>\n",
       "      <td></td>\n",
       "      <td>Foreign direct investment are the net inflows ...</td>\n",
       "      <td></td>\n",
       "      <td>Annual</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>Weighted average</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>Note: Data are based on the sixth edition of t...</td>\n",
       "      <td>International Monetary Fund, International Fin...</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>Open</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>BN.TRF.KOGT.CD</td>\n",
       "      <td>Economic Policy &amp; Debt: Balance of payments: C...</td>\n",
       "      <td>Net capital account (BoP, current US$)</td>\n",
       "      <td></td>\n",
       "      <td>Net capital account records acquisitions and d...</td>\n",
       "      <td></td>\n",
       "      <td>Annual</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>Note: Data are based on the sixth edition of t...</td>\n",
       "      <td>International Monetary Fund, Balance of Paymen...</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>Open</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "             SeriesCode                                              Topic  \\\n",
       "0        BN.KLT.DINV.CD  Economic Policy & Debt: Balance of payments: C...   \n",
       "1  BX.KLT.DINV.WD.GD.ZS  Economic Policy & Debt: Balance of payments: C...   \n",
       "2     BX.KLT.DINV.CD.WD  Economic Policy & Debt: Balance of payments: C...   \n",
       "3     BM.KLT.DINV.GD.ZS  Economic Policy & Debt: Balance of payments: C...   \n",
       "4        BN.TRF.KOGT.CD  Economic Policy & Debt: Balance of payments: C...   \n",
       "\n",
       "                                       IndicatorName ShortDefinition  \\\n",
       "0  Foreign direct investment, net (BoP, current US$)                   \n",
       "1  Foreign direct investment, net inflows (% of GDP)                   \n",
       "2  Foreign direct investment, net inflows (BoP, c...                   \n",
       "3  Foreign direct investment, net outflows (% of ...                   \n",
       "4             Net capital account (BoP, current US$)                   \n",
       "\n",
       "                                      LongDefinition UnitOfMeasure  \\\n",
       "0  Foreign direct investment are the net inflows ...                 \n",
       "1  Foreign direct investment are the net inflows ...                 \n",
       "2  Foreign direct investment refers to direct inv...                 \n",
       "3  Foreign direct investment are the net inflows ...                 \n",
       "4  Net capital account records acquisitions and d...                 \n",
       "\n",
       "  Periodicity BasePeriod OtherNotes AggregationMethod  \\\n",
       "0      Annual                                           \n",
       "1      Annual                        Weighted average   \n",
       "2      Annual                                     Sum   \n",
       "3      Annual                        Weighted average   \n",
       "4      Annual                                           \n",
       "\n",
       "                            LimitationsAndExceptions NotesFromOriginalSource  \\\n",
       "0                                                                              \n",
       "1  FDI data do not give a complete picture of int...                           \n",
       "2  FDI data do not give a complete picture of int...                           \n",
       "3                                                                              \n",
       "4                                                                              \n",
       "\n",
       "                                     GeneralComments  \\\n",
       "0  Note: Data are based on the sixth edition of t...   \n",
       "1  Note: Data starting from 2005 are based on the...   \n",
       "2  Note: Data starting from 2005 are based on the...   \n",
       "3  Note: Data are based on the sixth edition of t...   \n",
       "4  Note: Data are based on the sixth edition of t...   \n",
       "\n",
       "                                              Source  \\\n",
       "0  International Monetary Fund, Balance of Paymen...   \n",
       "1  International Monetary Fund, International Fin...   \n",
       "2  International Monetary Fund, Balance of Paymen...   \n",
       "3  International Monetary Fund, International Fin...   \n",
       "4  International Monetary Fund, Balance of Paymen...   \n",
       "\n",
       "                    StatisticalConceptAndMethodology  \\\n",
       "0                                                      \n",
       "1  Data on equity flows are based on balance of p...   \n",
       "2  Data on equity flows are based on balance of p...   \n",
       "3                                                      \n",
       "4                                                      \n",
       "\n",
       "                                DevelopmentRelevance RelatedSourceLinks  \\\n",
       "0                                                                         \n",
       "1  Private financial flows - equity and debt - ac...                      \n",
       "2  Private financial flows - equity and debt - ac...                      \n",
       "3                                                                         \n",
       "4                                                                         \n",
       "\n",
       "  OtherWebLinks RelatedIndicators LicenseType  \n",
       "0                                        Open  \n",
       "1                                        Open  \n",
       "2                                        Open  \n",
       "3                                        Open  \n",
       "4                                        Open  "
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "series_data = pd.read_sql(\"SELECT * FROM Series\", conn)\n",
    "series_data.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>CountryCode</th>\n",
       "      <th>Region</th>\n",
       "      <th>IncomeGroup</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AFG</td>\n",
       "      <td>South Asia</td>\n",
       "      <td>Low income</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>ALB</td>\n",
       "      <td>Europe &amp; Central Asia</td>\n",
       "      <td>Upper middle income</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>DZA</td>\n",
       "      <td>Middle East &amp; North Africa</td>\n",
       "      <td>Upper middle income</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>ASM</td>\n",
       "      <td>East Asia &amp; Pacific</td>\n",
       "      <td>Upper middle income</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>ADO</td>\n",
       "      <td>Europe &amp; Central Asia</td>\n",
       "      <td>High income: nonOECD</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  CountryCode                      Region           IncomeGroup\n",
       "0         AFG                  South Asia            Low income\n",
       "1         ALB       Europe & Central Asia   Upper middle income\n",
       "2         DZA  Middle East & North Africa   Upper middle income\n",
       "3         ASM         East Asia & Pacific   Upper middle income\n",
       "4         ADO       Europe & Central Asia  High income: nonOECD"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Selecting columns\n",
    "country_columns = pd.read_sql(\"SELECT CountryCode, Region, IncomeGroup FROM Country\", conn)\n",
    "country_columns.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>SeriesCode</th>\n",
       "      <th>Topic</th>\n",
       "      <th>LongDefinition</th>\n",
       "      <th>AggregationMethod</th>\n",
       "      <th>LimitationsAndExceptions</th>\n",
       "      <th>Source</th>\n",
       "      <th>StatisticalConceptAndMethodology</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>BN.KLT.DINV.CD</td>\n",
       "      <td>Economic Policy &amp; Debt: Balance of payments: C...</td>\n",
       "      <td>Foreign direct investment are the net inflows ...</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>International Monetary Fund, Balance of Paymen...</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>BX.KLT.DINV.WD.GD.ZS</td>\n",
       "      <td>Economic Policy &amp; Debt: Balance of payments: C...</td>\n",
       "      <td>Foreign direct investment are the net inflows ...</td>\n",
       "      <td>Weighted average</td>\n",
       "      <td>FDI data do not give a complete picture of int...</td>\n",
       "      <td>International Monetary Fund, International Fin...</td>\n",
       "      <td>Data on equity flows are based on balance of p...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>BX.KLT.DINV.CD.WD</td>\n",
       "      <td>Economic Policy &amp; Debt: Balance of payments: C...</td>\n",
       "      <td>Foreign direct investment refers to direct inv...</td>\n",
       "      <td>Sum</td>\n",
       "      <td>FDI data do not give a complete picture of int...</td>\n",
       "      <td>International Monetary Fund, Balance of Paymen...</td>\n",
       "      <td>Data on equity flows are based on balance of p...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>BM.KLT.DINV.GD.ZS</td>\n",
       "      <td>Economic Policy &amp; Debt: Balance of payments: C...</td>\n",
       "      <td>Foreign direct investment are the net inflows ...</td>\n",
       "      <td>Weighted average</td>\n",
       "      <td></td>\n",
       "      <td>International Monetary Fund, International Fin...</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>BN.TRF.KOGT.CD</td>\n",
       "      <td>Economic Policy &amp; Debt: Balance of payments: C...</td>\n",
       "      <td>Net capital account records acquisitions and d...</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>International Monetary Fund, Balance of Paymen...</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "             SeriesCode                                              Topic  \\\n",
       "0        BN.KLT.DINV.CD  Economic Policy & Debt: Balance of payments: C...   \n",
       "1  BX.KLT.DINV.WD.GD.ZS  Economic Policy & Debt: Balance of payments: C...   \n",
       "2     BX.KLT.DINV.CD.WD  Economic Policy & Debt: Balance of payments: C...   \n",
       "3     BM.KLT.DINV.GD.ZS  Economic Policy & Debt: Balance of payments: C...   \n",
       "4        BN.TRF.KOGT.CD  Economic Policy & Debt: Balance of payments: C...   \n",
       "\n",
       "                                      LongDefinition AggregationMethod  \\\n",
       "0  Foreign direct investment are the net inflows ...                     \n",
       "1  Foreign direct investment are the net inflows ...  Weighted average   \n",
       "2  Foreign direct investment refers to direct inv...               Sum   \n",
       "3  Foreign direct investment are the net inflows ...  Weighted average   \n",
       "4  Net capital account records acquisitions and d...                     \n",
       "\n",
       "                            LimitationsAndExceptions  \\\n",
       "0                                                      \n",
       "1  FDI data do not give a complete picture of int...   \n",
       "2  FDI data do not give a complete picture of int...   \n",
       "3                                                      \n",
       "4                                                      \n",
       "\n",
       "                                              Source  \\\n",
       "0  International Monetary Fund, Balance of Paymen...   \n",
       "1  International Monetary Fund, International Fin...   \n",
       "2  International Monetary Fund, Balance of Paymen...   \n",
       "3  International Monetary Fund, International Fin...   \n",
       "4  International Monetary Fund, Balance of Paymen...   \n",
       "\n",
       "                    StatisticalConceptAndMethodology  \n",
       "0                                                     \n",
       "1  Data on equity flows are based on balance of p...  \n",
       "2  Data on equity flows are based on balance of p...  \n",
       "3                                                     \n",
       "4                                                     "
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "series_columns = pd.read_sql(\"SELECT SeriesCode, Topic, LongDefinition, AggregationMethod, LimitationsAndExceptions, Source, StatisticalConceptAndMethodology FROM Series\", conn)\n",
    "series_columns.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[('AFG', 'South Asia', 'Low income'),\n",
       " ('ALB', 'Europe & Central Asia', 'Upper middle income'),\n",
       " ('DZA', 'Middle East & North Africa', 'Upper middle income'),\n",
       " ('ASM', 'East Asia & Pacific', 'Upper middle income'),\n",
       " ('ADO', 'Europe & Central Asia', 'High income: nonOECD'),\n",
       " ('AGO', 'Sub-Saharan Africa', 'Upper middle income'),\n",
       " ('ATG', 'Latin America & Caribbean', 'High income: nonOECD'),\n",
       " ('ARB', '', ''),\n",
       " ('ARG', 'Latin America & Caribbean', 'High income: nonOECD'),\n",
       " ('ARM', 'Europe & Central Asia', 'Lower middle income'),\n",
       " ('ABW', 'Latin America & Caribbean', 'High income: nonOECD'),\n",
       " ('AUS', 'East Asia & Pacific', 'High income: OECD'),\n",
       " ('AUT', 'Europe & Central Asia', 'High income: OECD'),\n",
       " ('AZE', 'Europe & Central Asia', 'Upper middle income'),\n",
       " ('BHR', 'Middle East & North Africa', 'High income: nonOECD'),\n",
       " ('BGD', 'South Asia', 'Lower middle income'),\n",
       " ('BRB', 'Latin America & Caribbean', 'High income: nonOECD'),\n",
       " ('BLR', 'Europe & Central Asia', 'Upper middle income'),\n",
       " ('BEL', 'Europe & Central Asia', 'High income: OECD'),\n",
       " ('BLZ', 'Latin America & Caribbean', 'Upper middle income'),\n",
       " ('BEN', 'Sub-Saharan Africa', 'Low income'),\n",
       " ('BMU', 'North America', 'High income: nonOECD'),\n",
       " ('BTN', 'South Asia', 'Lower middle income'),\n",
       " ('BOL', 'Latin America & Caribbean', 'Lower middle income'),\n",
       " ('BIH', 'Europe & Central Asia', 'Upper middle income'),\n",
       " ('BWA', 'Sub-Saharan Africa', 'Upper middle income'),\n",
       " ('BRA', 'Latin America & Caribbean', 'Upper middle income'),\n",
       " ('BRN', 'East Asia & Pacific', 'High income: nonOECD'),\n",
       " ('BGR', 'Europe & Central Asia', 'Upper middle income'),\n",
       " ('BFA', 'Sub-Saharan Africa', 'Low income'),\n",
       " ('BDI', 'Sub-Saharan Africa', 'Low income'),\n",
       " ('CPV', 'Sub-Saharan Africa', 'Lower middle income'),\n",
       " ('KHM', 'East Asia & Pacific', 'Low income'),\n",
       " ('CMR', 'Sub-Saharan Africa', 'Lower middle income'),\n",
       " ('CAN', 'North America', 'High income: OECD'),\n",
       " ('CSS', '', ''),\n",
       " ('CYM', 'Latin America & Caribbean', 'High income: nonOECD'),\n",
       " ('CAF', 'Sub-Saharan Africa', 'Low income'),\n",
       " ('CEB', '', ''),\n",
       " ('TCD', 'Sub-Saharan Africa', 'Low income'),\n",
       " ('CHI', 'Europe & Central Asia', 'High income: nonOECD'),\n",
       " ('CHL', 'Latin America & Caribbean', 'High income: OECD'),\n",
       " ('CHN', 'East Asia & Pacific', 'Upper middle income'),\n",
       " ('COL', 'Latin America & Caribbean', 'Upper middle income'),\n",
       " ('COM', 'Sub-Saharan Africa', 'Low income'),\n",
       " ('COG', 'Sub-Saharan Africa', 'Lower middle income'),\n",
       " ('CRI', 'Latin America & Caribbean', 'Upper middle income'),\n",
       " ('CIV', 'Sub-Saharan Africa', 'Lower middle income'),\n",
       " ('HRV', 'Europe & Central Asia', 'High income: nonOECD'),\n",
       " ('CUB', 'Latin America & Caribbean', 'Upper middle income'),\n",
       " ('CUW', 'Latin America & Caribbean', 'High income: nonOECD'),\n",
       " ('CYP', 'Europe & Central Asia', 'High income: nonOECD'),\n",
       " ('CZE', 'Europe & Central Asia', 'High income: OECD'),\n",
       " ('PRK', 'East Asia & Pacific', 'Low income'),\n",
       " ('ZAR', 'Sub-Saharan Africa', 'Low income'),\n",
       " ('DNK', 'Europe & Central Asia', 'High income: OECD'),\n",
       " ('DJI', 'Middle East & North Africa', 'Lower middle income'),\n",
       " ('DMA', 'Latin America & Caribbean', 'Upper middle income'),\n",
       " ('DOM', 'Latin America & Caribbean', 'Upper middle income'),\n",
       " ('EAS', '', ''),\n",
       " ('EAP', '', ''),\n",
       " ('ECU', 'Latin America & Caribbean', 'Upper middle income'),\n",
       " ('EGY', 'Middle East & North Africa', 'Lower middle income'),\n",
       " ('SLV', 'Latin America & Caribbean', 'Lower middle income'),\n",
       " ('GNQ', 'Sub-Saharan Africa', 'High income: nonOECD'),\n",
       " ('ERI', 'Sub-Saharan Africa', 'Low income'),\n",
       " ('EST', 'Europe & Central Asia', 'High income: OECD'),\n",
       " ('ETH', 'Sub-Saharan Africa', 'Low income'),\n",
       " ('EMU', '', ''),\n",
       " ('ECS', '', ''),\n",
       " ('ECA', '', ''),\n",
       " ('EUU', '', ''),\n",
       " ('FRO', 'Europe & Central Asia', 'High income: nonOECD'),\n",
       " ('FJI', 'East Asia & Pacific', 'Upper middle income'),\n",
       " ('FIN', 'Europe & Central Asia', 'High income: OECD'),\n",
       " ('FCS', '', ''),\n",
       " ('FRA', 'Europe & Central Asia', 'High income: OECD'),\n",
       " ('PYF', 'East Asia & Pacific', 'High income: nonOECD'),\n",
       " ('GAB', 'Sub-Saharan Africa', 'Upper middle income'),\n",
       " ('GEO', 'Europe & Central Asia', 'Lower middle income'),\n",
       " ('DEU', 'Europe & Central Asia', 'High income: OECD'),\n",
       " ('GHA', 'Sub-Saharan Africa', 'Lower middle income'),\n",
       " ('GRC', 'Europe & Central Asia', 'High income: OECD'),\n",
       " ('GRL', 'Europe & Central Asia', 'High income: nonOECD'),\n",
       " ('GRD', 'Latin America & Caribbean', 'Upper middle income'),\n",
       " ('GUM', 'East Asia & Pacific', 'High income: nonOECD'),\n",
       " ('GTM', 'Latin America & Caribbean', 'Lower middle income'),\n",
       " ('GIN', 'Sub-Saharan Africa', 'Low income'),\n",
       " ('GNB', 'Sub-Saharan Africa', 'Low income'),\n",
       " ('GUY', 'Latin America & Caribbean', 'Lower middle income'),\n",
       " ('HTI', 'Latin America & Caribbean', 'Low income'),\n",
       " ('HPC', '', ''),\n",
       " ('HIC', '', ''),\n",
       " ('NOC', '', ''),\n",
       " ('OEC', '', ''),\n",
       " ('HND', 'Latin America & Caribbean', 'Lower middle income'),\n",
       " ('HKG', 'East Asia & Pacific', 'High income: nonOECD'),\n",
       " ('HUN', 'Europe & Central Asia', 'High income: OECD'),\n",
       " ('ISL', 'Europe & Central Asia', 'High income: OECD'),\n",
       " ('IND', 'South Asia', 'Lower middle income'),\n",
       " ('IDN', 'East Asia & Pacific', 'Lower middle income'),\n",
       " ('IRN', 'Middle East & North Africa', 'Upper middle income'),\n",
       " ('IRQ', 'Middle East & North Africa', 'Upper middle income'),\n",
       " ('IRL', 'Europe & Central Asia', 'High income: OECD'),\n",
       " ('IMY', 'Europe & Central Asia', 'High income: nonOECD'),\n",
       " ('ISR', 'Middle East & North Africa', 'High income: OECD'),\n",
       " ('ITA', 'Europe & Central Asia', 'High income: OECD'),\n",
       " ('JAM', 'Latin America & Caribbean', 'Upper middle income'),\n",
       " ('JPN', 'East Asia & Pacific', 'High income: OECD'),\n",
       " ('JOR', 'Middle East & North Africa', 'Upper middle income'),\n",
       " ('KAZ', 'Europe & Central Asia', 'Upper middle income'),\n",
       " ('KEN', 'Sub-Saharan Africa', 'Lower middle income'),\n",
       " ('KIR', 'East Asia & Pacific', 'Lower middle income'),\n",
       " ('KOR', 'East Asia & Pacific', 'High income: OECD'),\n",
       " ('KSV', 'Europe & Central Asia', 'Lower middle income'),\n",
       " ('KWT', 'Middle East & North Africa', 'High income: nonOECD'),\n",
       " ('KGZ', 'Europe & Central Asia', 'Lower middle income'),\n",
       " ('LAO', 'East Asia & Pacific', 'Lower middle income'),\n",
       " ('LCN', '', ''),\n",
       " ('LAC', '', ''),\n",
       " ('LVA', 'Europe & Central Asia', 'High income: nonOECD'),\n",
       " ('LDC', '', ''),\n",
       " ('LBN', 'Middle East & North Africa', 'Upper middle income'),\n",
       " ('LSO', 'Sub-Saharan Africa', 'Lower middle income'),\n",
       " ('LBR', 'Sub-Saharan Africa', 'Low income'),\n",
       " ('LBY', 'Middle East & North Africa', 'Upper middle income'),\n",
       " ('LIE', 'Europe & Central Asia', 'High income: nonOECD'),\n",
       " ('LTU', 'Europe & Central Asia', 'High income: nonOECD'),\n",
       " ('LMY', '', ''),\n",
       " ('LIC', '', ''),\n",
       " ('LMC', '', ''),\n",
       " ('LUX', 'Europe & Central Asia', 'High income: OECD'),\n",
       " ('MAC', 'East Asia & Pacific', 'High income: nonOECD'),\n",
       " ('MKD', 'Europe & Central Asia', 'Upper middle income'),\n",
       " ('MDG', 'Sub-Saharan Africa', 'Low income'),\n",
       " ('MWI', 'Sub-Saharan Africa', 'Low income'),\n",
       " ('MYS', 'East Asia & Pacific', 'Upper middle income'),\n",
       " ('MDV', 'South Asia', 'Upper middle income'),\n",
       " ('MLI', 'Sub-Saharan Africa', 'Low income'),\n",
       " ('MLT', 'Middle East & North Africa', 'High income: nonOECD'),\n",
       " ('MHL', 'East Asia & Pacific', 'Upper middle income'),\n",
       " ('MRT', 'Sub-Saharan Africa', 'Lower middle income'),\n",
       " ('MUS', 'Sub-Saharan Africa', 'Upper middle income'),\n",
       " ('MEX', 'Latin America & Caribbean', 'Upper middle income'),\n",
       " ('FSM', 'East Asia & Pacific', 'Lower middle income'),\n",
       " ('MEA', '', ''),\n",
       " ('MNA', '', ''),\n",
       " ('MIC', '', ''),\n",
       " ('MDA', 'Europe & Central Asia', 'Lower middle income'),\n",
       " ('MCO', 'Europe & Central Asia', 'High income: nonOECD'),\n",
       " ('MNG', 'East Asia & Pacific', 'Upper middle income'),\n",
       " ('MNE', 'Europe & Central Asia', 'Upper middle income'),\n",
       " ('MAR', 'Middle East & North Africa', 'Lower middle income'),\n",
       " ('MOZ', 'Sub-Saharan Africa', 'Low income'),\n",
       " ('MMR', 'East Asia & Pacific', 'Lower middle income'),\n",
       " ('NAM', 'Sub-Saharan Africa', 'Upper middle income'),\n",
       " ('NPL', 'South Asia', 'Low income'),\n",
       " ('NLD', 'Europe & Central Asia', 'High income: OECD'),\n",
       " ('NCL', 'East Asia & Pacific', 'High income: nonOECD'),\n",
       " ('NZL', 'East Asia & Pacific', 'High income: OECD'),\n",
       " ('NIC', 'Latin America & Caribbean', 'Lower middle income'),\n",
       " ('NER', 'Sub-Saharan Africa', 'Low income'),\n",
       " ('NGA', 'Sub-Saharan Africa', 'Lower middle income'),\n",
       " ('NAC', '', ''),\n",
       " ('MNP', 'East Asia & Pacific', 'High income: nonOECD'),\n",
       " ('NOR', 'Europe & Central Asia', 'High income: OECD'),\n",
       " ('OED', '', ''),\n",
       " ('OMN', 'Middle East & North Africa', 'High income: nonOECD'),\n",
       " ('OSS', '', ''),\n",
       " ('PSS', '', ''),\n",
       " ('PAK', 'South Asia', 'Lower middle income'),\n",
       " ('PLW', 'East Asia & Pacific', 'Upper middle income'),\n",
       " ('PAN', 'Latin America & Caribbean', 'Upper middle income'),\n",
       " ('PNG', 'East Asia & Pacific', 'Lower middle income'),\n",
       " ('PRY', 'Latin America & Caribbean', 'Upper middle income'),\n",
       " ('PER', 'Latin America & Caribbean', 'Upper middle income'),\n",
       " ('PHL', 'East Asia & Pacific', 'Lower middle income'),\n",
       " ('POL', 'Europe & Central Asia', 'High income: OECD'),\n",
       " ('PRT', 'Europe & Central Asia', 'High income: OECD'),\n",
       " ('PRI', 'Latin America & Caribbean', 'High income: nonOECD'),\n",
       " ('QAT', 'Middle East & North Africa', 'High income: nonOECD'),\n",
       " ('ROM', 'Europe & Central Asia', 'Upper middle income'),\n",
       " ('RUS', 'Europe & Central Asia', 'High income: nonOECD'),\n",
       " ('RWA', 'Sub-Saharan Africa', 'Low income'),\n",
       " ('WSM', 'East Asia & Pacific', 'Lower middle income'),\n",
       " ('SMR', 'Europe & Central Asia', 'High income: nonOECD'),\n",
       " ('STP', 'Sub-Saharan Africa', 'Lower middle income'),\n",
       " ('SAU', 'Middle East & North Africa', 'High income: nonOECD'),\n",
       " ('SEN', 'Sub-Saharan Africa', 'Lower middle income'),\n",
       " ('SRB', 'Europe & Central Asia', 'Upper middle income'),\n",
       " ('SYC', 'Sub-Saharan Africa', 'High income: nonOECD'),\n",
       " ('SLE', 'Sub-Saharan Africa', 'Low income'),\n",
       " ('SGP', 'East Asia & Pacific', 'High income: nonOECD'),\n",
       " ('SXM', 'Latin America & Caribbean', 'High income: nonOECD'),\n",
       " ('SVK', 'Europe & Central Asia', 'High income: OECD'),\n",
       " ('SVN', 'Europe & Central Asia', 'High income: OECD'),\n",
       " ('SST', '', ''),\n",
       " ('SLB', 'East Asia & Pacific', 'Lower middle income'),\n",
       " ('SOM', 'Sub-Saharan Africa', 'Low income'),\n",
       " ('ZAF', 'Sub-Saharan Africa', 'Upper middle income'),\n",
       " ('SAS', '', ''),\n",
       " ('SSD', 'Sub-Saharan Africa', 'Low income'),\n",
       " ('ESP', 'Europe & Central Asia', 'High income: OECD'),\n",
       " ('LKA', 'South Asia', 'Lower middle income'),\n",
       " ('KNA', 'Latin America & Caribbean', 'High income: nonOECD'),\n",
       " ('LCA', 'Latin America & Caribbean', 'Upper middle income'),\n",
       " ('MAF', 'Latin America & Caribbean', 'High income: nonOECD'),\n",
       " ('VCT', 'Latin America & Caribbean', 'Upper middle income'),\n",
       " ('SSF', '', ''),\n",
       " ('SSA', '', ''),\n",
       " ('SDN', 'Sub-Saharan Africa', 'Lower middle income'),\n",
       " ('SUR', 'Latin America & Caribbean', 'Upper middle income'),\n",
       " ('SWZ', 'Sub-Saharan Africa', 'Lower middle income'),\n",
       " ('SWE', 'Europe & Central Asia', 'High income: OECD'),\n",
       " ('CHE', 'Europe & Central Asia', 'High income: OECD'),\n",
       " ('SYR', 'Middle East & North Africa', 'Lower middle income'),\n",
       " ('TJK', 'Europe & Central Asia', 'Lower middle income'),\n",
       " ('TZA', 'Sub-Saharan Africa', 'Low income'),\n",
       " ('THA', 'East Asia & Pacific', 'Upper middle income'),\n",
       " ('BHS', 'Latin America & Caribbean', 'High income: nonOECD'),\n",
       " ('GMB', 'Sub-Saharan Africa', 'Low income'),\n",
       " ('TMP', 'East Asia & Pacific', 'Lower middle income'),\n",
       " ('TGO', 'Sub-Saharan Africa', 'Low income'),\n",
       " ('TON', 'East Asia & Pacific', 'Upper middle income'),\n",
       " ('TTO', 'Latin America & Caribbean', 'High income: nonOECD'),\n",
       " ('TUN', 'Middle East & North Africa', 'Upper middle income'),\n",
       " ('TUR', 'Europe & Central Asia', 'Upper middle income'),\n",
       " ('TKM', 'Europe & Central Asia', 'Upper middle income'),\n",
       " ('TCA', 'Latin America & Caribbean', 'High income: nonOECD'),\n",
       " ('TUV', 'East Asia & Pacific', 'Upper middle income'),\n",
       " ('UGA', 'Sub-Saharan Africa', 'Low income'),\n",
       " ('UKR', 'Europe & Central Asia', 'Lower middle income'),\n",
       " ('ARE', 'Middle East & North Africa', 'High income: nonOECD'),\n",
       " ('GBR', 'Europe & Central Asia', 'High income: OECD'),\n",
       " ('USA', 'North America', 'High income: OECD'),\n",
       " ('UMC', '', ''),\n",
       " ('URY', 'Latin America & Caribbean', 'High income: nonOECD'),\n",
       " ('UZB', 'Europe & Central Asia', 'Lower middle income'),\n",
       " ('VUT', 'East Asia & Pacific', 'Lower middle income'),\n",
       " ('VEN', 'Latin America & Caribbean', 'High income: nonOECD'),\n",
       " ('VNM', 'East Asia & Pacific', 'Lower middle income'),\n",
       " ('VIR', 'Latin America & Caribbean', 'High income: nonOECD'),\n",
       " ('WBG', 'Middle East & North Africa', 'Lower middle income'),\n",
       " ('WLD', '', ''),\n",
       " ('YEM', 'Middle East & North Africa', 'Lower middle income'),\n",
       " ('ZMB', 'Sub-Saharan Africa', 'Lower middle income'),\n",
       " ('ZWE', 'Sub-Saharan Africa', 'Low income')]"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Merging tables\n",
    "merged_data = engine.execute('SELECT CountryCode, Region, IncomeGroup FROM Country').fetchall()\n",
    "[*merged_data]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>0</th>\n",
       "      <th>1</th>\n",
       "      <th>2</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AFG</td>\n",
       "      <td>South Asia</td>\n",
       "      <td>Low income</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>ALB</td>\n",
       "      <td>Europe &amp; Central Asia</td>\n",
       "      <td>Upper middle income</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>DZA</td>\n",
       "      <td>Middle East &amp; North Africa</td>\n",
       "      <td>Upper middle income</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>ASM</td>\n",
       "      <td>East Asia &amp; Pacific</td>\n",
       "      <td>Upper middle income</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>ADO</td>\n",
       "      <td>Europe &amp; Central Asia</td>\n",
       "      <td>High income: nonOECD</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "     0                           1                     2\n",
       "0  AFG                  South Asia            Low income\n",
       "1  ALB       Europe & Central Asia   Upper middle income\n",
       "2  DZA  Middle East & North Africa   Upper middle income\n",
       "3  ASM         East Asia & Pacific   Upper middle income\n",
       "4  ADO       Europe & Central Asia  High income: nonOECD"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merged_data_df = pd.DataFrame(merged_data)\n",
    "merged_data_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.1"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
